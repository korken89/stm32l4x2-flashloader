# Flash loader for 128 kB STM32L4x2

## Instructions to run

1. Generate binary:

```console
cargo objcopy --release --bin stm32l4x2_flashloader -- -O binary loader.bin
```

2. Generate the base64 encoded blob:

```console
 base64 -w 0 loader.bin
```

Which gave the following in my case:

```
AIAAIL0CACBXAwAgWwMAIFcDACBXAwAgVwMAIAAAAAAAAAAAAAAAAAAAAABXAwAgVwMAIAAAAABXAwAgVwMAIAAAAABP9P9hQPb6cwHqECFC8hQAxPICAAJomkMRRAIxAWABaEH0gDEBYFD4BBzJAwzVUPgEHMkDRL9Q+AQcX+rBMQPVUPgEHMkD7tRQ+AQcAmgi8AICAmA4IMDyAQAIQBi/ASBwR0LyFADE8gIAAWhB8AQBAWABaEH0gDEBYFD4BBzJAwzVUPgEHMkDRL9Q+AQcX+rBMQPVUPgEHMkD7tRQ+AQcAmgi8AQCAmA4IMDyAQAIQBi/ASBwR0LyCABA8iMRxPICAMTyZ1EBYEj2qxHM9u9RAWDAaMAPcEfwtQOvLekABwHwBwhA8jgMQvIQA6HrCA7A8gEMxPICA77xCA8v0xZG8kZms6rxCAoG8QgJNGh2aF1oRfABBV1gBGBGYBxo5ANEvxxoX+rENAXVHGjkAwLVHGjkA/LUHGgU6gwPadEcaAgwTkbkBx6/HGgk8AEEHGBcaLrxCA8k8AEEXGDR0rjxAA9l0ALrDgYKRBL4AR2WQmHw/wEj0BL4AV2WQkXqASUg0BL4AU2WQkTqBSge0BL4AU2WQkTqCC4c0BL4AU2WQkTqDi4a0BL4AR2WQkHqDiEX0BL4ASxC6gEhQkYS4E/w/zIP4E/w/zIpRgvgT/D/MkFGB+BP8P8ycUYD4ApGcUYA4CpGXmhG8AEGXmABYEJgGGjAA0S/GGhf6sAwBdUYaMADAtUYaMAD8tQYaBDqDA8D0AEgvegAB/C9GGjABx6/GGgg8AEAGGBYaCDwAQBYYAAgvegAB/C9QvIUAMTyAgABaEHwAEEBYAAgcEeAtW9GAPAB+P7egLVvRv/3LP8AIP/3zv7/9/3+ACAAIQAi//cz///34f/+54C1b0YA8Er4RPIAAETyAAHC8gAAwvIAAYFCFNJE8gABACLC8gABQfgEK4FCPL9B+AQrgUIH0kH4BCuBQgPSQfgEK4FC79NE8gAARPIAAcLyAADC8gABgUIc0kDycDFE8gACwvIAAcLyAAILaEL4BDuCQg/SS2hC+AQ7gkI+v4toQvgEO4JCBdLLaBAxQvgEO4JC6tP/957//t7+53BHcEYEIQhCAtHv8wiAAuDv8wmA/+f+5w==
```

3. Update the yaml file:

```yaml
  stm32l4xx_128:
    name: stm32l4xx_128
    description: STM32L4xx 128 KB Flash
    default: true
    instructions: AIAAIL0CACBXAwAgWwMAIFcDACBXAwAgVwMAIAAAAAAAAAAAAAAAAAAAAABXAwAgVwMAIAAAAABXAwAgVwMAIAAAAABP9P9hQPb6cwHqECFC8hQAxPICAAJomkMRRAIxAWABaEH0gDEBYFD4BBzJAwzVUPgEHMkDRL9Q+AQcX+rBMQPVUPgEHMkD7tRQ+AQcAmgi8AICAmA4IMDyAQAIQBi/ASBwR0LyFADE8gIAAWhB8AQBAWABaEH0gDEBYFD4BBzJAwzVUPgEHMkDRL9Q+AQcX+rBMQPVUPgEHMkD7tRQ+AQcAmgi8AQCAmA4IMDyAQAIQBi/ASBwR0LyCABA8iMRxPICAMTyZ1EBYEj2qxHM9u9RAWDAaMAPcEfwtQOvLekABwHwBwhA8jgMQvIQA6HrCA7A8gEMxPICA77xCA8v0xZG8kZms6rxCAoG8QgJNGh2aF1oRfABBV1gBGBGYBxo5ANEvxxoX+rENAXVHGjkAwLVHGjkA/LUHGgU6gwPadEcaAgwTkbkBx6/HGgk8AEEHGBcaLrxCA8k8AEEXGDR0rjxAA9l0ALrDgYKRBL4AR2WQmHw/wEj0BL4AV2WQkXqASUg0BL4AU2WQkTqBSge0BL4AU2WQkTqCC4c0BL4AU2WQkTqDi4a0BL4AR2WQkHqDiEX0BL4ASxC6gEhQkYS4E/w/zIP4E/w/zIpRgvgT/D/MkFGB+BP8P8ycUYD4ApGcUYA4CpGXmhG8AEGXmABYEJgGGjAA0S/GGhf6sAwBdUYaMADAtUYaMAD8tQYaBDqDA8D0AEgvegAB/C9GGjABx6/GGgg8AEAGGBYaCDwAQBYYAAgvegAB/C9QvIUAMTyAgABaEHwAEEBYAAgcEeAtW9GAPAB+P7egLVvRv/3LP8AIP/3zv7/9/3+ACAAIQAi//cz///34f/+54C1b0YA8Er4RPIAAETyAAHC8gAAwvIAAYFCFNJE8gABACLC8gABQfgEK4FCPL9B+AQrgUIH0kH4BCuBQgPSQfgEK4FC79NE8gAARPIAAcLyAADC8gABgUIc0kDycDFE8gACwvIAAcLyAAILaEL4BDuCQg/SS2hC+AQ7gkI+v4toQvgEO4JCBdLLaBAxQvgEO4JC6tP/957//t7+53BHcEYEIQhCAtHv8wiAAuDv8wmA/+f+5w==
    pc_init: 251
    pc_uninit: 637
    pc_program_page: 285
    pc_erase_sector: 69
    pc_erase_all: 167
    data_section_offset: 896
    flash_properties:
      address_range:
        start: 134217728
        end: 134348800
      page_size: 1024
      erased_byte_value: 255
      program_page_timeout: 400
      erase_sector_timeout: 400
      sectors:
        - size: 2048
          address: 0
```
